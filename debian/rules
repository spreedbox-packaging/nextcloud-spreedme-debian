#!/usr/bin/make -f
# -*- makefile -*-

#export DH_VERBOSE=1
export DH_OPTIONS
#export DEB_BUILD_OPTIONS=nocheck

export QUILT_PATCHES=debian/patches

%:
	dh $@

override_dh_clean:
	dh_clean

	quilt pop -a || true

override_dh_auto_build:
	# no building required

	quilt push -a

override_dh_auto_install:
	dh_auto_install

	# Configuration for Owncloud application
	cp config/config.php.in debian/owncloud-spreedme/etc/spreedme/owncloud/config.php
	ln -s /etc/spreedme/owncloud/config.php debian/owncloud-spreedme/usr/lib/owncloud/www/apps/spreedme/config

	# Configuration for spreed-webrtc plugin
	mv extra/static/config/OwnCloudConfig.js.in debian/owncloud-spreedme/etc/spreedme/owncloud/OwnCloudConfig.js
	ln -s /etc/spreedme/owncloud/OwnCloudConfig.js debian/owncloud-spreedme/usr/lib/owncloud/www/apps/spreedme/extra/static/config/OwnCloudConfig.js
